{"ast":null,"code":"import{useState}from\"react\";import{useEffect}from\"react\";import axios from\"axios\";import useInterval from'@use-it/interval';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export function Messages(_ref){let{currentUser,selectedRoom}=_ref;const[currentMessage,setCurrentMessage]=useState(\"\");const[messages,setMessages]=useState([]);function handleMessageChange(e){setCurrentMessage(e.target.value);}async function loadMessages(){const result=await axios.post(\"/getmessages\",{selectedRoom:selectedRoom});setMessages(result.data.reverse());}async function handleMessageSend(e){e.preventDefault();await axios.post(\"/sendmessage\",{currentUser:currentUser,currentMessage:currentMessage,selectedRoom:selectedRoom});setCurrentMessage(\"\");loadMessages();}useEffect(()=>{loadMessages();setCurrentMessage(\"\");},[selectedRoom]);useInterval(()=>{loadMessages();},2000);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"messagesContainer1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"messagesContainer2\",children:messages.map(function(message){return/*#__PURE__*/_jsxs(\"div\",{className:\"messageContainer\",children:[message[2]&&message[4]&&/*#__PURE__*/_jsxs(\"div\",{className:\"nameContainer\",children:[/*#__PURE__*/_jsx(\"div\",{className:(!message[2]||message[1]===currentUser)&&\"invisible\",children:message[1]}),message[4]&&/*#__PURE__*/_jsx(\"div\",{className:\"date\",children:new Date(message[3]).toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:(!message[2]||message[1]!==currentUser)&&\"invisible\",children:message[1]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:message[1]===currentUser?\"user message\":\"other message\",children:message[0]})})]},message[3]);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"messageInputContainer\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleMessageSend,children:[/*#__PURE__*/_jsx(\"input\",{value:currentMessage,onChange:handleMessageChange,type:\"text\",placeholder:\"message \".concat(selectedRoom),className:\"messageInput\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sendButton\",children:\"Send\"})]})})]});}","map":{"version":3,"names":["useState","useEffect","axios","useInterval","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Messages","_ref","currentUser","selectedRoom","currentMessage","setCurrentMessage","messages","setMessages","handleMessageChange","e","target","value","loadMessages","result","post","data","reverse","handleMessageSend","preventDefault","children","className","map","message","Date","toLocaleString","onSubmit","onChange","type","placeholder","concat"],"sources":["/Users/eddyzheng/Documents/Javascript Projects/node test/chatapp/client/src/Messages.js"],"sourcesContent":["import { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport useInterval from '@use-it/interval';\n\nexport function Messages({currentUser, selectedRoom}) {\n    const [currentMessage, setCurrentMessage] = useState(\"\");\n    const [messages, setMessages] = useState([]);\n    \n    function handleMessageChange(e) {\n        setCurrentMessage(e.target.value);\n    }\n\n    async function loadMessages() {\n        const result = await axios.post(\"/getmessages\", {selectedRoom: selectedRoom});\n        setMessages(result.data.reverse());\n    }\n\n    async function handleMessageSend(e) {\n        e.preventDefault();\n        await axios.post(\"/sendmessage\", {currentUser: currentUser, currentMessage: currentMessage, selectedRoom: selectedRoom});\n        setCurrentMessage(\"\");\n        loadMessages();\n    }\n\n    useEffect(() => {\n        loadMessages();\n        setCurrentMessage(\"\");\n    }, [selectedRoom]);\n\n    useInterval(() => {\n        loadMessages();\n    }, 2000);\n\n    return (\n        <>  \n            <div className=\"messagesContainer1\">\n                <div className=\"messagesContainer2\">\n                    {messages.map(function(message) {\n                        return (\n                            <div className=\"messageContainer\" key={message[3]}>\n                                { \n                                    message[2] && message[4] &&\n                                    <div className=\"nameContainer\">\n                                        <div \n                                        className={(!message[2] || message[1] === currentUser) && \"invisible\"}>\n                                            {message[1]}\n                                        </div>\n                                        {message[4] && <div className=\"date\">{(new Date(message[3])).toLocaleString()}</div>}\n                                        <div \n                                        className={(!message[2] || message[1] !== currentUser) && \"invisible\"}>\n                                            {message[1]}\n                                        </div>\n                                    </div>\n                                }\n                                <div>\n                                    <button className={message[1] === currentUser? \"user message\" : \"other message\"}>\n                                        {message[0]} \n                                    </button>\n                                </div>\n                            </div>\n                        )\n                    })}\n                </div>\n            </div>\n            <div className=\"messageInputContainer\">\n                <form onSubmit={handleMessageSend}>\n                    <input\n                        value={currentMessage}\n                        onChange={handleMessageChange}\n                        type=\"text\"\n                        placeholder={`message ${selectedRoom}`}\n                        className=\"messageInput\"\n                    />\n                    <button className=\"sendButton\">Send</button>\n                </form>\n            </div>\n        </>\n    )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}